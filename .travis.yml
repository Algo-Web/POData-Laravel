language: php

php:
  - 7.1
  - 7.2
  - 7.3
  - 7.4
  - nightly
  
before_script:
  - mkdir -p bootstrap/cache
  - chmod 777 bootstrap/cache
  - ls -al bootstrap/
  - ls -al bootstrap/cache
  - composer global require hirak/prestissimo
  - if [ "$LARAVEL_DEP" == "5.1.*" ]; then composer require phpunit/phpunit "^5.6" --no-update --dev; fi;
  - composer require laravel/framework:${LARAVEL_DEP} --no-update
  - COMPOSER_MEMORY_LIMIT=-1 travis_retry composer install --prefer-dist --no-interaction -o
  - cat composer.lock


script:
  - mkdir -p build/logs
  - php vendor/bin/phpunit --coverage-clover build/logs/clover.xml

after_script:
  - php vendor/bin/php-coveralls --exclude-no-stmt

after_success:
  - coveralls

env: # important!
  - LARAVEL_DEP=5.1.*
  - LARAVEL_DEP=">5.1.11"
matrix:
  allow_failures:
  - php: nightly
  - php: 7.4

